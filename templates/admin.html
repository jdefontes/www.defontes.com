<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Admin </title>
    <link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico" />

    <link rel="stylesheet" type="text/css" href="/style/admin.css" />
    <style>
        html, body, #left, #right { height: 100%; margin: 0; padding: 0;}
        #left { width: 30%; background-color: red; position: absolute;}
        #right {width: 70%; background-color: orange; position: absolute; right: 0;}
    </style>
    <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
</head>
<body>
<div id="left"></div>
<div id="right"></div>
</body>
<script>

    var bindChildren = function(parent, resource) {
        var ul = $("<ul>");
        parent.append(ul);
        $.each(resource.child_resources, function() {
            var child = this;
            var li = $("<li>");
            var div = $("<div>").text(child.path);
            li.append(div);
            if (child.class_name == "Folder") {
                div.click(function () {
                    var subtree = li.children("ul");
                    if (subtree.length == 0) {
                        loadFolder(li, child.path);
                    } else {
                        subtree.toggle();
                    }
                });
            }
            ul.append(li);
        });
    };
    
    var loadFolder = function(parent, path) {
        $.ajax({
            url: path,
            data: {rand : Math.random()},
            dataType: "json"
        }).done(function(resource) {
            bindChildren(parent, resource);
        });
    };
    
    $(function () {
        $("#left").text("Loading...");
        var ul = $("<ul>");
        var li = $("<li>").text("/");
        ul.append(li);
        loadFolder(li, "/");
        $("#left").empty().append(ul);
    });
</script>
</html>